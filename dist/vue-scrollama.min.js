var VueScrollama=function(e){"use strict";function t(e){return"scrollama__debug-offset--"+e}function n(e){!function(e){var n=e.id,r=e.offsetVal,o=e.stepClass,i=document.createElement("div");i.id=t(n),i.className="scrollama__debug-offset",i.style.position="fixed",i.style.left="0",i.style.width="100%",i.style.height="0",i.style.borderTop="2px dashed black",i.style.zIndex="9999";var s=document.createElement("p");s.innerHTML='".'+o+'" trigger: <span>'+r+"</span>",s.style.fontSize="12px",s.style.fontFamily="monospace",s.style.color="black",s.style.margin="0",s.style.padding="6px",i.appendChild(s),document.body.appendChild(i)}({id:e.id,offsetVal:e.offsetVal,stepClass:e.stepEl[0].className})}function r(e){var t=e.id,n=e.index,r=e.state,o="scrollama__debug-step--"+t+"-"+n,i=document.getElementById(o+"_above"),s=document.getElementById(o+"_below"),a="enter"===r?"block":"none";i&&(i.style.display=a),s&&(s.style.display=a)}function o(){var e=["stepAbove","stepBelow","stepProgress","viewportAbove","viewportBelow"],o={},i={},s=null,a=[],c=[],l=[],f=[],u=0,d=0,p=0,v=0,g=0,m=0,h=!1,b=!1,x=!1,w=!1,y=!1,_=!1,E="down",S="percent",C=[];function M(e){console.error("scrollama error: "+e)}function R(){o={stepEnter:function(){},stepExit:function(){},stepProgress:function(){}},i={}}function I(e){return e.getBoundingClientRect().top+window.pageYOffset-(document.body.clientTop||0)}function O(e){return+e.getAttribute("data-scrollama-index")}function $(){window.pageYOffset>g?E="down":window.pageYOffset<g&&(E="up"),g=window.pageYOffset}function A(e){i[e]&&i[e].forEach((function(e){return e.disconnect()}))}function T(){var e,n;p=window.innerHeight,e=document.body,n=document.documentElement,v=Math.max(e.scrollHeight,e.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight),d=u*("pixels"===S?1:p),h&&(c=a.map((function(e){return e.getBoundingClientRect().height})),l=a.map(I),b&&L()),x&&function(e){var n=e.id,r=e.offsetMargin,o=e.offsetVal,i="pixels"===e.format?"px":"",s=t(n),a=document.getElementById(s);a.style.top=r+"px",a.querySelector("span").innerText=""+o+i}({id:s,offsetMargin:d,offsetVal:u,format:S})}function V(t){if(t&&!b){if(!h)return M("scrollama error: enable() called before scroller was ready"),void(b=!1);L()}!t&&b&&e.forEach(A),b=t}function B(e,t){var n=O(e);void 0!==t&&(f[n].progress=t);var r={element:e,index:n,progress:f[n].progress};"enter"===f[n].state&&o.stepProgress(r)}function H(e,t){if("above"===t)for(var n=0;n<e;n+=1){var r=f[n];"enter"!==r.state&&"down"!==r.direction?(N(a[n],"down",!1),P(a[n],"down")):"enter"===r.state&&P(a[n],"down")}else if("below"===t)for(var o=f.length-1;o>e;o-=1){var i=f[o];"enter"===i.state&&P(a[o],"up"),"down"===i.direction&&(N(a[o],"up",!1),P(a[o],"up"))}}function N(e,t,n){void 0===n&&(n=!0);var i=O(e),a={element:e,index:i,direction:t};f[i].direction=t,f[i].state="enter",y&&n&&"down"===t&&H(i,"above"),y&&n&&"up"===t&&H(i,"below"),o.stepEnter&&!C[i]&&(o.stepEnter(a,f),x&&r({id:s,index:i,state:"enter"}),_&&(C[i]=!0)),w&&B(e)}function P(e,t){var n=O(e),i={element:e,index:n,direction:t};w&&("down"===t&&f[n].progress<1?B(e,1):"up"===t&&f[n].progress>0&&B(e,0)),f[n].direction=t,f[n].state="exit",o.stepExit(i,f),x&&r({id:s,index:n,state:"exit"})}function k(e){var t=e[0];$();var n=t.isIntersecting,r=t.boundingClientRect,o=t.target,i=r.top,s=r.bottom,a=i-d,c=s-d,l=O(o),u=f[l];n&&a<=0&&c>=0&&"down"===E&&"enter"!==u.state&&N(o,E),!n&&a>0&&"up"===E&&"enter"===u.state&&P(o,E)}function F(e){var t=e[0];$();var n=t.isIntersecting,r=t.boundingClientRect,o=t.target,i=r.top,s=r.bottom,a=i-d,c=s-d,l=O(o),u=f[l];n&&a<=0&&c>=0&&"up"===E&&"enter"!==u.state&&N(o,E),!n&&c<0&&"down"===E&&"enter"===u.state&&P(o,E)}function z(e){var t=e[0];$();var n=t.isIntersecting,r=t.target,o=O(r),i=f[o];n&&"down"===E&&"down"!==i.direction&&"enter"!==i.state&&(N(r,"down"),P(r,"down"))}function q(e){var t=e[0];$();var n=t.isIntersecting,r=t.target,o=O(r),i=f[o];n&&"up"===E&&"down"===i.direction&&"enter"!==i.state&&(N(r,"up"),P(r,"up"))}function Y(e){var t=e[0];$();var n=t.isIntersecting,r=t.intersectionRatio,o=t.boundingClientRect,i=t.target,s=o.bottom;n&&s-d>=0&&B(i,+r)}function j(){i.stepProgress=a.map((function(e,t){var n=c[t]-d+"px 0px "+(-p+d)+"px 0px",r=function(e){for(var t=Math.ceil(e/m),n=[],r=1/t,o=0;o<t;o+=1)n.push(o*r);return n}(c[t]),o=new IntersectionObserver(Y,{rootMargin:n,threshold:r});return o.observe(e),o}))}function L(){e.forEach(A),i.viewportAbove=a.map((function(e,t){var n=v-l[t],r=d-p-c[t],o=new IntersectionObserver(z,{rootMargin:n+"px 0px "+r+"px 0px"});return o.observe(e),o})),i.viewportBelow=a.map((function(e,t){var n=-d-c[t],r=d-p+c[t]+v,o=new IntersectionObserver(q,{rootMargin:n+"px 0px "+r+"px 0px"});return o.observe(e),o})),i.stepAbove=a.map((function(e,t){var n=-d+c[t],r=new IntersectionObserver(k,{rootMargin:n+"px 0px "+(d-p)+"px 0px"});return r.observe(e),r})),i.stepBelow=a.map((function(e,t){var n=-d,r=d-p+c[t],o=new IntersectionObserver(F,{rootMargin:n+"px 0px "+r+"px 0px"});return o.observe(e),o})),w&&j()}function D(e){return!(!e||1!==e.nodeType)&&(function(e){var t=window.getComputedStyle(e);return("scroll"===t.overflowY||"auto"===t.overflowY)&&e.scrollHeight>e.clientHeight}(e)?e:D(e.parentNode))}var U={};return U.setup=function(e){var t=e.step,r=e.parent,o=e.offset;void 0===o&&(o=.5);var i=e.progress;void 0===i&&(i=!1);var c=e.threshold;void 0===c&&(c=4);var l=e.debug;void 0===l&&(l=!1);var d=e.order;void 0===d&&(d=!0);var p,v,g,b=e.once;if(void 0===b&&(b=!1),R(),v=(p="abcdefghijklmnopqrstuv").length,g=Date.now(),s=""+[0,0,0].map((function(e){return p[Math.floor(Math.random()*v)]})).join("")+g,!(a=function(e,t){return void 0===t&&(t=document),"string"==typeof e?Array.from(t.querySelectorAll(e)):e instanceof Element?[e]:e instanceof NodeList?Array.from(e):e instanceof Array?e:[]}(t,r)).length)return M("no step elements"),U;var E=a.reduce((function(e,t){return e||D(t.parentNode)}),!1);return E&&console.error("scrollama error: step elements cannot be children of a scrollable element. Remove any css on the parent element with overflow: scroll; or overflow: auto; on elements with fixed height.",E),x=l,w=i,y=d,_=b,U.offsetTrigger(o),m=Math.max(1,+c),h=!0,x&&n({id:s,stepEl:a,offsetVal:u}),a.forEach((function(e,t){return e.setAttribute("data-scrollama-index",t)})),f=a.map((function(){return{direction:null,state:null,progress:0}})),T(),U.enable(),U},U.resize=function(){return T(),U},U.enable=function(){return V(!0),U},U.disable=function(){return V(!1),U},U.destroy=function(){V(!1),R()},U.offsetTrigger=function(e){if(null===e)return u;if("number"==typeof e)S="percent",e>1&&M("offset value is greater than 1. Fallback to 1."),e<0&&M("offset value is lower than 0. Fallback to 0."),u=Math.min(Math.max(0,e),1);else if("string"==typeof e&&e.indexOf("px")>0){var t=+e.replace("px","");isNaN(t)?(M("offset value must be in 'px' format. Fallback to 0.5."),u=.5):(S="pixels",u=t)}else M("offset value does not include 'px'. Fallback to 0.5."),u=.5;return U},U.onStepEnter=function(e){return"function"==typeof e?o.stepEnter=e:M("onStepEnter requires a function"),U},U.onStepExit=function(e){return"function"==typeof e?o.stepExit=e:M("onStepExit requires a function"),U},U.onStepProgress=function(e){return"function"==typeof e?o.stepProgress=e:M("onStepProgress requires a function"),U},U}function i(e,t,n,r,o,i,s,a,c,l){"boolean"!=typeof s&&(c=a,a=s,s=!1);var f,u="function"==typeof n?n.options:n;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),r&&(u._scopeId=r),i?(f=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=f):t&&(f=s?function(e){t.call(this,l(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),f)if(u.functional){var d=u.render;u.render=function(e,t){return f.call(t),d(e,t)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,f):[f]}return n}var s=i({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"scrollama__steps"},[e._t("default")],2)},staticRenderFns:[]},undefined,{inheritAttrs:!1,name:"Scrollama",mounted:function(){this._scroller=o(),this.setup()},beforeDestroy:function(){this._scroller.destroy()},computed:{opts:function(){return Object.assign({},{step:Array.from(this.$el.children),progress:!!this.$listeners["step-progress"]},this.$attrs)}},methods:{setup:function(){var e=this;this._scroller.destroy(),this._scroller.setup(this.opts).onStepProgress((function(t){e.$emit("step-progress",t)})).onStepEnter((function(t){e.$emit("step-enter",t)})).onStepExit((function(t){e.$emit("step-exit",t)})),window.addEventListener("resize",this.handleResize)},handleResize:function(){this._scroller.resize()}}},undefined,false,undefined,!1,void 0,void 0,void 0);return void 0!==typeof Vue&&Vue.component("Scrollama",s),e.default=s,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
