var VueScrollama=function(e){"use strict";function t(e){return"scrollama__debug-offset--"+e}function n(e){!function(e){var n=e.id,r=e.offsetVal,o=e.stepClass,i=document.createElement("div");i.id=t(n),i.className="scrollama__debug-offset",i.style.position="fixed",i.style.left="0",i.style.width="100%",i.style.height="0",i.style.borderTop="2px dashed black",i.style.zIndex="9999";var s=document.createElement("p");s.innerHTML='".'+o+'" trigger: <span>'+r+"</span>",s.style.fontSize="12px",s.style.fontFamily="monospace",s.style.color="black",s.style.margin="0",s.style.padding="6px",i.appendChild(s),document.body.appendChild(i)}({id:e.id,offsetVal:e.offsetVal,stepClass:e.stepEl[0].className})}function r(e){var t=e.id,n=e.index,r=e.state,o="scrollama__debug-step--"+t+"-"+n,i=document.getElementById(o+"_above"),s=document.getElementById(o+"_below"),a="enter"===r?"block":"none";i&&(i.style.display=a),s&&(s.style.display=a)}function o(){var e=["stepAbove","stepBelow","stepProgress","viewportAbove","viewportBelow"],o={},i={},s=null,a=[],c=[],l=[],d=[],f=0,u=0,p=0,h=0,v=0,m=0,g=!1,b=!1,_=!1,x=!1,w=!1,y=!1,E="down",O="percent",C=[];function z(e){console.error("scrollama error: "+e)}function S(){o={stepEnter:function(){},stepExit:function(){},stepProgress:function(){}},i={}}function R(e){return e.getBoundingClientRect().top+window.pageYOffset-(document.body.clientTop||0)}function $(e){return+e.getAttribute("data-scrollama-index")}function I(){window.pageYOffset>v?E="down":window.pageYOffset<v&&(E="up"),v=window.pageYOffset}function M(e){i[e]&&i[e].forEach((function(e){return e.disconnect()}))}function H(){var e,n;p=window.innerHeight,e=document.body,n=document.documentElement,h=Math.max(e.scrollHeight,e.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight),u=f*("pixels"===O?1:p),g&&(c=a.map((function(e){return e.getBoundingClientRect().height})),l=a.map(R),b&&Y()),_&&function(e){var n=e.id,r=e.offsetMargin,o=e.offsetVal,i="pixels"===e.format?"px":"",s=t(n),a=document.getElementById(s);a.style.top=r+"px",a.querySelector("span").innerText=""+o+i}({id:s,offsetMargin:u,offsetVal:f,format:O})}function A(t){if(t&&!b){if(!g)return z("scrollama error: enable() called before scroller was ready"),void(b=!1);Y()}!t&&b&&e.forEach(M),b=t}function T(e,t){var n=$(e);void 0!==t&&(d[n].progress=t);var r={element:e,index:n,progress:d[n].progress};"enter"===d[n].state&&o.stepProgress(r)}function V(e,t){if("above"===t)for(var n=0;n<e;n+=1){var r=d[n];"enter"!==r.state&&"down"!==r.direction?(N(a[n],"down",!1),j(a[n],"down")):"enter"===r.state&&j(a[n],"down")}else if("below"===t)for(var o=d.length-1;o>e;o-=1){var i=d[o];"enter"===i.state&&j(a[o],"up"),"down"===i.direction&&(N(a[o],"up",!1),j(a[o],"up"))}}function N(e,t,n){void 0===n&&(n=!0);var i=$(e),a={element:e,index:i,direction:t};d[i].direction=t,d[i].state="enter",w&&n&&"down"===t&&V(i,"above"),w&&n&&"up"===t&&V(i,"below"),o.stepEnter&&!C[i]&&(o.stepEnter(a,d),_&&r({id:s,index:i,state:"enter"}),y&&(C[i]=!0)),x&&T(e)}function j(e,t){var n=$(e),i={element:e,index:n,direction:t};x&&("down"===t&&d[n].progress<1?T(e,1):"up"===t&&d[n].progress>0&&T(e,0)),d[n].direction=t,d[n].state="exit",o.stepExit(i,d),_&&r({id:s,index:n,state:"exit"})}function B(e){var t=e[0];I();var n=t.isIntersecting,r=t.boundingClientRect,o=t.target,i=r.top,s=r.bottom,a=i-u,c=s-u,l=$(o),f=d[l];n&&a<=0&&c>=0&&"down"===E&&"enter"!==f.state&&N(o,E),!n&&a>0&&"up"===E&&"enter"===f.state&&j(o,E)}function F(e){var t=e[0];I();var n=t.isIntersecting,r=t.boundingClientRect,o=t.target,i=r.top,s=r.bottom,a=i-u,c=s-u,l=$(o),f=d[l];n&&a<=0&&c>=0&&"up"===E&&"enter"!==f.state&&N(o,E),!n&&c<0&&"down"===E&&"enter"===f.state&&j(o,E)}function k(e){var t=e[0];I();var n=t.isIntersecting,r=t.target,o=$(r),i=d[o];n&&"down"===E&&"down"!==i.direction&&"enter"!==i.state&&(N(r,"down"),j(r,"down"))}function P(e){var t=e[0];I();var n=t.isIntersecting,r=t.target,o=$(r),i=d[o];n&&"up"===E&&"down"===i.direction&&"enter"!==i.state&&(N(r,"up"),j(r,"up"))}function q(e){var t=e[0];I();var n=t.isIntersecting,r=t.intersectionRatio,o=t.boundingClientRect,i=t.target,s=o.bottom;n&&s-u>=0&&T(i,+r)}function D(){i.stepProgress=a.map((function(e,t){var n=c[t]-u+"px 0px "+(-p+u)+"px 0px",r=function(e){for(var t=Math.ceil(e/m),n=[],r=1/t,o=0;o<t;o+=1)n.push(o*r);return n}(c[t]),o=new IntersectionObserver(q,{rootMargin:n,threshold:r});return o.observe(e),o}))}function Y(){e.forEach(M),i.viewportAbove=a.map((function(e,t){var n=h-l[t],r=u-p-c[t],o=new IntersectionObserver(k,{rootMargin:n+"px 0px "+r+"px 0px"});return o.observe(e),o})),i.viewportBelow=a.map((function(e,t){var n=-u-c[t],r=u-p+c[t]+h,o=new IntersectionObserver(P,{rootMargin:n+"px 0px "+r+"px 0px"});return o.observe(e),o})),i.stepAbove=a.map((function(e,t){var n=-u+c[t],r=new IntersectionObserver(B,{rootMargin:n+"px 0px "+(u-p)+"px 0px"});return r.observe(e),r})),i.stepBelow=a.map((function(e,t){var n=-u,r=u-p+c[t],o=new IntersectionObserver(F,{rootMargin:n+"px 0px "+r+"px 0px"});return o.observe(e),o})),x&&D()}function W(e){return!(!e||1!==e.nodeType)&&(function(e){var t=window.getComputedStyle(e);return("scroll"===t.overflowY||"auto"===t.overflowY)&&e.scrollHeight>e.clientHeight}(e)?e:W(e.parentNode))}var L={};return L.setup=function(e){var t=e.step,r=e.parent,o=e.offset;void 0===o&&(o=.5);var i=e.progress;void 0===i&&(i=!1);var c=e.threshold;void 0===c&&(c=4);var l=e.debug;void 0===l&&(l=!1);var u=e.order;void 0===u&&(u=!0);var p,h,v,b=e.once;if(void 0===b&&(b=!1),S(),h=(p="abcdefghijklmnopqrstuv").length,v=Date.now(),s=""+[0,0,0].map((function(e){return p[Math.floor(Math.random()*h)]})).join("")+v,!(a=function(e,t){return void 0===t&&(t=document),"string"==typeof e?Array.from(t.querySelectorAll(e)):e instanceof Element?[e]:e instanceof NodeList?Array.from(e):e instanceof Array?e:[]}(t,r)).length)return z("no step elements"),L;var E=a.reduce((function(e,t){return e||W(t.parentNode)}),!1);return E&&console.error("scrollama error: step elements cannot be children of a scrollable element. Remove any css on the parent element with overflow: scroll; or overflow: auto; on elements with fixed height.",E),_=l,x=i,w=u,y=b,L.offsetTrigger(o),m=Math.max(1,+c),g=!0,_&&n({id:s,stepEl:a,offsetVal:f}),a.forEach((function(e,t){return e.setAttribute("data-scrollama-index",t)})),d=a.map((function(){return{direction:null,state:null,progress:0}})),H(),L.enable(),L},L.resize=function(){return H(),L},L.enable=function(){return A(!0),L},L.disable=function(){return A(!1),L},L.destroy=function(){A(!1),S()},L.offsetTrigger=function(e){if(null===e)return f;if("number"==typeof e)O="percent",e>1&&z("offset value is greater than 1. Fallback to 1."),e<0&&z("offset value is lower than 0. Fallback to 0."),f=Math.min(Math.max(0,e),1);else if("string"==typeof e&&e.indexOf("px")>0){var t=+e.replace("px","");isNaN(t)?(z("offset value must be in 'px' format. Fallback to 0.5."),f=.5):(O="pixels",f=t)}else z("offset value does not include 'px'. Fallback to 0.5."),f=.5;return L},L.onStepEnter=function(e){return"function"==typeof e?o.stepEnter=e:z("onStepEnter requires a function"),L},L.onStepExit=function(e){return"function"==typeof e?o.stepExit=e:z("onStepExit requires a function"),L},L.onStepProgress=function(e){return"function"==typeof e?o.stepProgress=e:z("onStepProgress requires a function"),L},L}var i;function s(){s.init||(s.init=!0,i=-1!==function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var r=e.indexOf("Edge/");return r>0?parseInt(e.substring(r+5,e.indexOf(".",r)),10):-1}())}function a(e,t,n,r,o,i,s,a,c,l){"boolean"!=typeof s&&(c=a,a=s,s=!1);var d,f="function"==typeof n?n.options:n;if(e&&e.render&&(f.render=e.render,f.staticRenderFns=e.staticRenderFns,f._compiled=!0,o&&(f.functional=!0)),r&&(f._scopeId=r),i?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},f._ssrRegister=d):t&&(d=s?function(e){t.call(this,l(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),d)if(f.functional){var u=f.render;f.render=function(e,t){return d.call(t),u(e,t)}}else{var p=f.beforeCreate;f.beforeCreate=p?[].concat(p,d):[d]}return n}var c={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},mounted:function(){var e=this;s(),this.$nextTick((function(){e._w=e.$el.offsetWidth,e._h=e.$el.offsetHeight,e.emitOnMount&&e.emitSize()}));var t=document.createElement("object");this._resizeObject=t,t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex",-1),t.onload=this.addResizeHandlers,t.type="text/html",i&&this.$el.appendChild(t),t.data="about:blank",i||this.$el.appendChild(t)},beforeDestroy:function(){this.removeResizeHandlers()},methods:{compareAndNotify:function(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize:function(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers:function(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers:function(){this._resizeObject&&this._resizeObject.onload&&(!i&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}},l=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"resize-observer",attrs:{tabindex:"-1"}})};l._withStripped=!0;var d=a({render:l,staticRenderFns:[]},undefined,c,"data-v-8859cc6c",false,undefined,!1,void 0,void 0,void 0);var f={version:"1.0.1",install:function(e){e.component("resize-observer",d),e.component("ResizeObserver",d)}},u=null;function p(e,t,n,r,o,i,s,a,c,l){"boolean"!=typeof s&&(c=a,a=s,s=!1);var d,f="function"==typeof n?n.options:n;if(e&&e.render&&(f.render=e.render,f.staticRenderFns=e.staticRenderFns,f._compiled=!0,o&&(f.functional=!0)),r&&(f._scopeId=r),i?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},f._ssrRegister=d):t&&(d=s?function(e){t.call(this,l(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),d)if(f.functional){var u=f.render;f.render=function(e,t){return d.call(t),u(e,t)}}else{var p=f.beforeCreate;f.beforeCreate=p?[].concat(p,d):[d]}return n}"undefined"!=typeof window?u=window.Vue:"undefined"!=typeof global&&(u=global.Vue),u&&u.use(f);var h=p({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"scrollama-container",class:{"with-graphic":e.$slots.graphic},attrs:{id:"scrollama-container-"+e.id}},[n("div",{ref:"scrollama-graphic",staticClass:"scrollama-graphic",attrs:{id:"scrollama-graphic-"+e.id}},[e._t("graphic")],2),e._v(" "),n("div",{staticClass:"scrollama-steps",attrs:{id:"scrollama-steps-"+e.id}},[e._t("default")],2),e._v(" "),n("resize-observer",{on:{notify:e.handleResize}})],1)},staticRenderFns:[]},undefined,{name:"Scrollama",components:{ResizeObserver:d},props:{id:{type:String,validator:function(e){return!/\s/.test(e)},default:function(){return Math.random().toString(36).substr(2,9)}}},mounted:function(){this._scroller=o(),this.setup()},beforeDestroy:function(){this._scroller.destroy()},computed:{opts:function(){return Object.assign({},this.$attrs,{step:"#scrollama-steps-"+this.id+">div",container:"#scrollama-container-"+this.id,graphic:"#scrollama-graphic-"+this.id})}},methods:{setup:function(){var e=this;this._scroller.destroy(),this._scroller.setup(this.opts).onStepProgress((function(t){e.$emit("step-progress",t)})).onStepEnter((function(t){e.$emit("step-enter",t)})).onStepExit((function(t){e.$emit("step-exit",t)})),this._scroller.resize()},handleResize:function(){this._scroller.resize()}}},undefined,false,undefined,!1,void 0,void 0,void 0);return void 0!==typeof Vue&&Vue.component("Scrollama",h),e.default=h,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
